<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title> Underscore--JavaScript 工具库</title>
	<script src="API/underscore-min.js" ></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
		<style>
		em{
			color:red;
			font-size:18px;
		}
		a{
			text-decoration:none;
			color:rgba(0,0,255,0.6);
		}

	</style>
</head>
<body>
	<section>
		<h3>什么是Underscore</h3>
		<h4>1.相关概念</h4>
		<p> Underscore 是一个 <em>JavaScript 工具库（必须导入）</em>，它提供了一整套函数式编程的实用功能，但是没有扩展任何 JavaScript 内置对象。  他弥补了 jQuery 没有实现的功能，同时又是 Backbone 必不可少的部分。Underscore 提供了100多个函数，包括常用的：map、filter、invoke — 当然还有更多专业的辅助函数，如：函数绑定、JavaScript 模板功能、创建快速索引、强类型相等测试等等。 </p>
		<h4>2.<em>"_"</em>对象及其方法</h4>
		<p>Underscore定义一个下划线（_）对象，函数库的所有方法都属于这个对象，方法大致可以分成集合（collection）、数组（array）、函数（function）、对象（object）和工具（utility）五大类</p>
		<pre>
		简单介绍五类方法，详细请参考Underscore.js中文API
		  ①集合（collection）：
		  	这里提供的方法可供数组和对象使用，方便遍历，查找以及处理。
		  	提供了类似ES5对Array增加的那些方法，比如map、filter、some、each...

		  ②数组（array）：
		  	提供方法供数组使用，包含对数组的查找，分组，生成

		  ③函数（function）：
		  	提供的方法用于函数上，包含对动态this的绑定，延时执行

		  ④对象（object）：
		  	提供的方法供对象使用，包含检索，克隆等，以及一些isXXX的判断

		  ⑤工具（utility）：
		  	产生随机数，html模板生成
		</pre>
		<h4>3.<a href="https://segmentfault.com/a/1190000007447416" target="_blank">源码浅析</a></h4>
		<p>1）underscore.js中所有的函数和方法都在一个闭包里：(function() {...}.call(this));这么做的目的是为了避免污染全局变量</p>
		<p>2）为了压缩代码，underscore中用到将原型赋值给变量保存的方法</p>
		<p>3）创建了一个"_"对象，之后将underscore中的相关方法添加到"_"原型中，那么创建的"_"对象也就具备了underscore方法</p>
		<p>4）Underscored 的三个<em>最常用</em>的方法： _.each()、_.template()、_.filter()
</p>
	</section>
	<hr>
	<section>
		<h3>为什么要使用Underscore</h3>
		<pre>
		举例说明：
			'use strict';
			var a1 = [1, 4, 9, 16];
			var a2 = a1.map(Math.sqrt);
			console.log(a2); // Array [ 1, 2, 3, 4 ],原数组被“映射”成对应新数组
			var a3 = a2.filter((x) => { return x % 2 === 0; }); 
			console.log(a3);//Array [ 2, 4 ]

		现在问题来了，Array有map()和filter()方法，可是Object没有这些方法。此外，低版本的浏览器例如IE6～8也没有这些方法，怎么办？
		解决方法：
			方法一，自己把这些方法添加到Array.prototype中，然后给Object.prototype也加上mapObject()等类似的方法。

			方法二，直接找一个成熟可靠的第三方开源库，使用统一的函数来实现map()、filter()这些操作。

		正如jQuery统一了不同浏览器之间的DOM操作的差异，让我们可以简单地对DOM进行操作，underscore则提供了一套完善的函数式编程的接口，让我们更方便地在JavaScript中实现函数式编程。

		jQuery在加载时，会把自身绑定到唯一的全局变量$上，underscore与其类似，<em>会把自身绑定到唯一的全局变量_上</em>，这也是为啥它的名字叫underscore的原因。
		
																<a href="http://www.css88.com/archives/5710#more-5710"  target="_blank">你可能不再需要Underscore</a>
		</pre>
	</section>
	<hr>
	<section>
		<h3>怎么使用Underscore</h3>
		<h4>1.<a href="http://www.bootcss.com/p/underscore/" target="_blank">Underscore.js中文文档</a></h4>
		<h4>2.常用方法</h4>
		<p>1）_.each：写看得懂的循环</p>
		<pre>
		_.each()接受两个参数：

		    需要遍历的 Array（或者Object）
		    回调函数
		</pre>
		<script>
			//循环遍历
			var artists = ['Pharrel Williams', 'Led Zeppelin', 'Rolling Stones'];
			for(var i = 0; i< artists.length; i++) {
			   console.log('artist: ' + artists[i]);
			}
			//使用_.each(),对于 Array 中每一个元素（文档中称为 iteratee ），_.each()都将调用回调函数。在回调函数中我们可以访问三个参数：
			//当前迭代的数组元素（artist）的值。例如，对于上面的代码段，在第一次迭代我们会得到“Pharrel Williams”这个值
			//当前迭代的序号（索引），在我们的这个例子下，是从0到2的数
			//被迭代的数组本身（artists）
			
			var artists = ['Pharrel Williams', 'Led Zeppelin', 'Rolling Stones'];
			_.each(artists, function(artist, index, artists) {
			   console.log('artist: ' + artist);
			});
		</script>
		<p>2）_.template:提供了一个<a href="temEngige.html" target="_blank">模板引擎</a></p>
		<pre>
		Underscore 的模板引擎不仅可以替换值，而且模板内部的脚本也可以被执行。
		</pre>
		<script>
			//我们用一个字符串参数来调用_.template()函数，这个参数包括用分隔符包含的一些数据（<%= artist%>）。当以这种方式调用_.template()的时候，会返回一个可复用的函数。
			//来调用我们的新函数artistTemplate()，传递文本作对象为参数，会返回我们最初传递到_.template()的字符串，但是其中的自由变量会被参数中相应的值替代。在这个例子下<%=artist%>会被参数中artist的值所取代。
		/*
			var artists = ['Led Zeppelin', 'ACDC', 'Rolling Stones'],
			   artistTemplate = _.template('<li><%= artist %></li>'),
			   content = '';
			   _.each(artists, function(artist, index, artists) {
			      content += artistTemplate({
			      artist: artist
			   });
			});
			 
			var container = document.createElement('ol');
			container.innerHTML = content;
			document.body.appendChild(container);
		*/
			//对_.each()的调用整合进模板，这使我们改变模板的调用方式。既然我们现在在_.template()函数中进行迭代，我们可以把整个的artists数组传入artistTemplate()（之前传递的是单个artist）
		/*
			var artists = ['Led Zeppelin', 'ACDC', 'Rolling Stones'],
			artistTemplate = _.template( '<% _.each(artists, function(artist, index, artists) { %>' + '<li><%= artist %></li>' + '<% }); %>' ),
			 content = artistTemplate({ artists: artists });
			var container = document.createElement('ol');
			container.innerHTML = content;
			document.body.appendChild(container);
		*/
		</script>
		<p>3)_.filter()：只需要一个布尔函数</p>
		<pre>
		_.filter()接收一个数组和一个回调函数作为参数。然后它会对数组中的每个元素调用回调函数，
		然后返回一个新数组，其中包含每个回调函数执行后返回真值的元素。

		回调函数也像_.each()一样接受三个参数：当前被遍历的元素值，被遍历值的索引，和数组本身。
		</pre>
		<script>
		/*
				var artists = ['Led Zeppelin', 'ACDC', 'Rolling Stones'],
				artistTemplate = _.template(
				 '<% _.each(artists, function(artist, index, artists) { %>' +
				   '<li><%= artist %></li>' +
				 '<% }); %>'
				),
				content = artistTemplate({
				  artists: _.filter(artists, function(artist, index, artists) {
				    return artist === 'ACDC';
				  })
				});
				var container = document.createElement('ol');
				container.innerHTML = content;
				document.body.appendChild(container);
		*/
		</script>
		<h4>3.Demo应用</h4>
		<a href="http://web.jobbole.com/87537/" target="_blank">Demo应用思路解析</a>
		<br>
		<a href="https://codepen.io/SitePoint/pen/OMyOVm" target="_blank">Demo应用--CodePen</a>

	</section>
</body>
</html>